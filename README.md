# Материалы выпускной квалификационной работы магистра ![Static Badge](https://img.shields.io/badge/МГТУ_им._Н.Э._Баумана-blue) ![Static Badge](https://img.shields.io/badge/ИУ6-darkred) ![Static Badge](https://img.shields.io/badge/09.04.01/07-purple)

|||
|-|-|
| Факультет  | Информатика и системы управления |
| Кафедра | Компьютерные системы и сети |
| Направление подготовки | Информатика и вычислительная техника |
| Магистерская программа | Интеллектуальные системы анализа, обработки и интерпретации больших данных |
| Тема | Программная система прогнозирования новых технологических областей |
| Я | Артём М. Панфилкин |

## Структура репозитория
```
├── Итоги на сайт
│   ├── 1 РПЗ.pdf
│   ├── 2 Графические листы.pdf
│   ├── 3 Направление на защиту.pdf
│   ├── 4 Отзыв руководителя.pdf
│   ├── 5 Акт о нормоконтроле.pdf
│   ├── 6 Рецензия с печатью.pdf
│   ├── 7 Справка о внедрении.pdf
│   ├── 8 Справка о статьях.pdf
│   ├── 9 Видеоролик.mov
│   └── 10 Доклад.pdf
└── Исходники
    ├── Листы
    │   ├── PlantUML - Прототипы некоторых листовы
    │   ├── Формы интерфейса - Скриншоты для листа 10
    │   ├── Листы.drawio - Все листы в формате drawio
    │   └── Анализ подходов.md - Лист 3 в формате MD
    ├── Схема БД.dbml - Не потребовалась для ВКРМ
    ├── Макет системы
    │   └── predictor-ui - Проект всего макета
    └── Документы - Исходники .docx
        ├── РПЗ.docx
        ├── Отзыв руководителя.docx
        ├── Доклад.docx
        ├── Справка о внедрении.docx
        ├── Задание и Календарный план.docx
        ├── Внешняя рецензия.docx
        ├── Приложение А РТЗ.docx
        ├── Приложение Б Листинги.docx
        └── Приложение В Графические материалы.docx
```

## О проекте
В систему загружаются файлы .csv, которые содержат информацию о патентах. В одном документе много патентов. Патенты в документе содержат следующую информацию: код патента (GA), название патента (Title), актуальность (Novelty), дата первой подачи (AppDate), присвоенные коды IPC (IPC), информация о цитировании.

После загрузки файла система парсит документ, вытаскивая из него всю эту информацию и загружает в три таблицы БД: Patents(GA, Title, Novelty, AppDate), PatentIPCs(GA, IPC), PatentCitations(GA, CitedGA). После обработки документа (нужно немного подождать) патенты доступны для анализа.

Далее пользователь может создать "набор данных" - набор фильтров, которые фильтруют данные: начало диапазона, конец диапазона, шаблон кодов IPC. То есть набор данных позволяет по заранее заданному правилу получить определенные патенты.

Далее пользователь может создать модель для анализа. Он выбирает набор данных, на котором будет основана модель и запускает создание (также занимает некоторое время). Построение модели выполняется по следующему принципу:
1. Сначала текст патента (Title+Novelty) преобразуется в вектор моделью SentenceTransformer. Сами вектора также хранятся в базе данных, позволяя в следующий раз не пересчитывать их.
2. Далее для векторов набора данных запускается кластеризация методом DBSCAN. Конечно верно утверждение, что кластеризация не используется для последующей классификации, однако тут есть небольшая хитрость.
3. После кластеризации выполняется оценка, насколько кластеризация повторяет классификацию. Для этого используется метрика Adjusted Rand Index.
4. Далее на основе метрики Adjusted Rand Index изменяется порог кластеризаци путем изменения параметра eps в DBSCAN. В идеале я хочу, чтобы порог кластеризации оптимизировался чем-то наподобие градиентного спуска с максимизации метрики (чем больше метрика, тем лучше).
6. После оптимизации порога происходит ассоциация меток кластеров с метками классов IPC, которые присутствуют в фильтре набора данных. Ассоциация происходит через попарное сравнение точности кластеризации и меток IPC (то есть если кластеризация хорошо повторяет классификацию, то метки кластеров можно считать метками классов).
7. Модель сохраняется в БД - записываются порог кластеризации, метрика Adjusted Rand Index, метки кластеров и ассоциированные с ними метки классов IPC.

После построения модели пользователь может посмотреть на патентный ландшафт, который строится с помощью UMAP. Для каждого кластера генерируются ключевые слова при помощи LDA.

Далее пользователь на основе модели строит прогнозную модель за следующий диапазон времени для таких же фильтров IPC как в первом наборе данных. Для этого он создает еше один набор данных. Создание прогнозной модели повторяет создание модели, однако используется уже вычесленный порог кластеризации. После построеия прогнозной модели (также занимает некоторое время) пользователь может посмотреть на прогнозный патентный ландшафт (также строится с помощью UMAP и LDA) в сравнении с патентном ландшафтом модели. Для более интерпретируемых результатов для двух ландшафтов строится матрица ассоциаций - матрица переходов между кластерами. По оси X - кластеры модели (с метками наиболее схожих классов), а по оси Y - кластеры прогнозной модели. В ячейках матрицы - процент соответствия (вычисляется аналогично вычислению соответствия кластеров к классам IPC). Однако и матрица ассоциаций не дает четкого представления о прогнозе. Для этого в настройках системы задается некоторый "порог соответствия" - порог, относительно которого рассматриваются ячейки таблицы. Например если в матрице в столбце или строке есть больше одной ячеки с повышенной точностью (то есть у истинной метки точность снизилась, а у другой повысилась для данного кластера), то это свидетельствует о больном числе новых патеетов на стыке двух классов, что означает некоторую вероятность образования нового класса, а следовательно новой технологической области. По аналогии рассматриваются все ячейки, так как может не быть образования нового класса, но просто общее падение точности для определенного класса, что может свидетельствовать о смене фокуса в данной технологической области, а также снова о появлении нового класса. Алгоритм генерации прогноза анализирует всю матрицу и выдает пользователю в читаемом виде гипотезы и их вероятности.

Можно заметить разделение на модули системы:
1. Модуль пользовательского интерфейса (то, с чем взаимодействует пользователь)
2. Модуль построения моделей (по большей части то что я описал выше)
3. Модуль визуализации (строит разные красивые графики)
4. Модуль генерации отчетов (генерирует гипотезы и их вероятности через матрицу ассоциации на основе двух наборов кластеров)

Несколько ключевых алгоритмов в системе прогнозирования появления новых технологических областей:
1. Парсинг патентных документов
2. Создание и обучение модели
3. Создание прогнозной модели
4. Генерация матрицы ассоциаций (как для модели, так и для проогнозной модели)
5. Генерация гипотез и их вероятностей
6. Оптимизация порога кластеризации
7. Ассоциация меток кластеров с метками классов IPC (это тоже самое, что и матрица ассоциаций)
8. Генерация патентного ландшафта, что включает в себя UMAP и LDA

## Запуск макета
1. Установить npm
2. Перейти в директорию проекта и установить зависимости `npm i`
3. Запустить проект `npm run dev`
